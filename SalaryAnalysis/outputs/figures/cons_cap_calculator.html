<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Cohort-aligned Salary Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<style>
  :root { --bg:#f7f9fc; --card:#fff; --text:#1f2d3d; --muted:#6b7280; --accent:#0f766e; --border:#e5e7eb; }
  html,body { margin:0; padding:0; background:var(--bg); color:var(--text);
               font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; }
  .wrap { max-width:1000px; margin:24px auto 48px; padding:0 16px; }
  h1 { font-size:1.6rem; margin:0 0 12px; }
  .subtle { color:var(--muted); }
  .grid { display:grid; grid-template-columns: 1.05fr 0.95fr; gap:16px; }
  .card { background:var(--card); border:1px solid var(--border); border-radius:12px; padding:14px; box-shadow:0 1px 2px rgba(0,0,0,.04); }
  .row { display:grid; grid-template-columns: 1fr 1fr; gap:12px; margin:8px 0; }
  label { font-weight:600; font-size:.95rem; }
  input,select { width:80%; padding:10px 12px; border:1px solid var(--border); border-radius:10px; background:#fff; }
  .hint { font-size:.85rem; color:var(--muted); margin-top:4px; }
  .btn { display:inline-block; padding:10px 14px; background:var(--accent); color:#fff; border-radius:10px; border:none; cursor:pointer; font-weight:600; }
  .mono { font-variant-numeric: tabular-nums; font-family: ui-monospace, SFMono-Regular, Menlo, monospace; }
  .note { font-size:.9rem; color:var(--muted); }
  table { width:100%; border-collapse:separate; border-spacing:0; margin-top:6px; }
  th, td { padding:10px 12px; border-bottom:1px solid var(--border); text-align:left; white-space:normal; word-wrap:break-word; }
  th { background:#f3f4f6; }
  .big { font-size:1.2rem; font-weight:700; }
  @media (max-width: 800px) { .grid { grid-template-columns: 1fr; } .row { grid-template-columns: 1fr; } }
</style>
</head>
<body>
<div class="wrap">
  <h1>SMA Cohort-aligned Salary Calculator<br>
    <span class="subtle">Uses your provided <b>Credited Years</b> directly.</span>
  </h1>

  <div class="grid">
    <div class="card">
      <div class="row">
        <div>
          <label>Credited Years</label>
          <input id="yrs" type="number" step="1" value="10">
          <div class="hint">These are the credited external years plus SMA tenured years.</div>
        </div>
        <div>
          <label>Current salary</label>
          <input id="curr" type="number" step="1" value="50000">
          <div class="hint">Used only for COLA comparison</div>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Degree Level</label>
          <select id="deg">
            <option>BA</option><option>MA</option><option>PhD</option>
          </select>
          <div class="hint">MA +4%, PhD +8%</div>
        </div>
        <div>
          <label>AP/Prep stipend</label>
          <select id="prep"><option value="0" selected>No</option><option value="1">Yes (+$0)</option></select>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Skill stipend</label>
          <select id="skillStip"><option value="0" selected>No</option><option value="1">Yes</option></select>
        </div>
        <div>
          <label>Leadership stipend</label>
          <select id="leadStip"><option value="0" selected>No</option><option value="1">Yes</option></select>
        </div>
      </div>

      <button class="btn" onclick="compute()">Compute</button>
    </div>

    <div class="card">
      <table>
        <thead>
          <tr><th>Step</th><th>Added</th><th>Running total</th></tr>
        </thead>
        <tbody>
          <tr><td>Baseline at credited years</td><td class="mono" id="add0"></td><td class="mono" id="down"></td></tr>
          <tr><td>After degree multiplier</td><td class="mono" id="addDeg"></td><td class="mono" id="degOut"></td></tr>
          <tr><td>+ Prep stipend</td><td class="mono" id="addPrep"></td><td class="mono" id="prepOut"></td></tr>
          <tr><td>+ Skill stipend</td><td class="mono" id="addSkill"></td><td class="mono" id="skillOut"></td></tr>
          <tr><td>+ Leadership stipend</td><td class="mono" id="addLead"></td><td class="mono" id="leadOut"></td></tr>
          <tr><td><b>Cohort-aligned Salary (after cap)</b></td><td class="mono" id="addCap"></td><td class="mono big" id="consCap"></td></tr>
        </tbody>
      </table>
      <hr/>
      <table>
        <tbody>
          <tr><td>COLA salary</td><td class="mono" id="colaOut"></td></tr>
          <tr><td><b>Paid (max of Cohort-aligned or COLA)</b></td><td class="mono big" id="paid"></td></tr>
        </tbody>
      </table>
      <div class="note" style="margin-top:8px">
        Anchors use band midpoints at P50 with +0% inflation.
      </div>
    </div>
  </div>
</div>

<script>
const CFG = {"xp": [2.5, 8.0, 13.0, 18.0, 23.0, 28.0, 33.0, 38.0, 43.5], "fp": [64785.0, 74252.0, 80145.0, 86615.0, 94077.0, 97001.0, 101073.0, 104439.0, 109084.0], "preDown": 0.04, "maPct": 0.04, "phdPct": 0.08, "prepBonus": 0.0, "skillBonus": 0.0, "leadBonus": 0.0, "maxSalary": 105000.0, "colaFloor": 0.03, "pTitle": 50, "inflPct": 0};

function money(x) {
  return (isFinite(x)) ? "$" + Math.round(x).toLocaleString() : "";
}

function interpWithTail(x, xp, fp) {
  if (xp.length < 2) return Array(x.length).fill(fp[0]);
  const x0 = xp[0], x1 = xp[xp.length-1];
  const y = new Array(x.length);
  for (let i=0;i<x.length;i++) {
    const xi = x[i];
    if (xi <= x0) {
      const mL = (fp[1]-fp[0])/(xp[1]-xp[0]);
      y[i] = fp[0] + mL*(xi - x0);
    } else if (xi >= x1) {
      const mR = (fp[fp.length-1]-fp[fp.length-2])/(xp[xp.length-1]-xp[xp.length-2]);
      y[i] = fp[fp.length-1] + mR*(xi - x1);
    } else {
      let j=1; while (xp[j] < xi) j++;
      const xL = xp[j-1], xR = xp[j], yL = fp[j-1], yR = fp[j];
      const t = (xi - xL)/(xR - xL);
      y[i] = yL + t*(yR - yL);
    }
  }
  return y;
}

function degreeMultiplier(deg, maPct, phdPct) {
  const d = String(deg || "").toLowerCase();
  if (d.includes("phd")) return 1 + phdPct;
  if (d.includes("ma"))  return 1 + maPct;
  return 1.0; // BA
}

function compute() {
  const yrs  = parseFloat(document.getElementById("yrs").value || "0");
  const deg  = document.getElementById("deg").value;
  const prep = parseInt(document.getElementById("prep").value || "0");
  const skillStip = parseInt(document.getElementById("skillStip").value || "0");
  const leadStip  = parseInt(document.getElementById("leadStip").value  || "0");
  const curr = parseFloat(document.getElementById("curr").value || "0");

  // Baseline @ credited years, then downshift
  const base = interpWithTail([yrs], CFG.xp, CFG.fp)[0];
  const down = base * (1 - CFG.preDown);
  document.getElementById("add0").textContent = "";        // nothing "added" here
  document.getElementById("down").textContent = money(down);

  // Degree multiplier
  const mult = degreeMultiplier(deg, CFG.maPct, CFG.phdPct);
  const afterDeg = down * mult;
  document.getElementById("addDeg").textContent = money(afterDeg - down);
  document.getElementById("degOut").textContent = money(afterDeg);

  // Stipends (raw + running total shown)
  const addPrep = prep ? CFG.prepBonus : 0;
  const afterPrep = afterDeg + addPrep;
  document.getElementById("addPrep").textContent = money(addPrep);
  document.getElementById("prepOut").textContent = money(afterPrep);

  const addSkill = skillStip ? CFG.skillBonus : 0;
  const afterSkill = afterPrep + addSkill;
  document.getElementById("addSkill").textContent = money(addSkill);
  document.getElementById("skillOut").textContent = money(afterSkill);

  const addLead = leadStip ? CFG.leadBonus : 0;
  const afterLead = afterSkill + addLead;
  document.getElementById("addLead").textContent = money(addLead);
  document.getElementById("leadOut").textContent = money(afterLead);

  // Cap
  const capped = Math.min(afterLead, CFG.maxSalary);
  document.getElementById("addCap").textContent = (capped < afterLead) ? ("âˆ’" + money(afterLead - capped)) : "";
  document.getElementById("consCap").textContent = money(capped);

  // COLA compare
  const colaSal = curr * (1 + CFG.colaFloor);
  document.getElementById("colaOut").textContent = money(colaSal);

  const paid = Math.max(colaSal, capped);
  document.getElementById("paid").textContent = money(paid);
}

compute();
</script>
</body>
</html>
